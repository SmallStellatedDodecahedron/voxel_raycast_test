<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Voxel build evo</title></head><body><h1 id="loading">LOADING</h1><div id="divzone"> </div><script name="f*ckedscript">const fov=1/Math.tan(44*Math.PI/180),rotspeedx=.003,rotspeedy=.003,movespeed=.13,size=100,sunsize=.02,skyvx=7,skyvy=2,skyvz=1,w=window.screen.width,h=window.screen.height,loading=document.getElementById("loading"),divzone=document.getElementById("divzone"),canv=document.createElement("canvas");canv.width=w,canv.height=h;const scaley=w>h?1:h/w,scalex=w>h?w/h:1;class PG{static rand256(e){return(this.seed>>(3&e)^e^Math.clz32(e^this.seed)*Math.floor(1/(3+Math.sin(e|this.seed)))^Math.clz32((832&e)*e&this.seed))>>(this.seed&e&15)&255}static gencolors(){let e=new Float32Array(1024),r=0;for(;r<1024;)e[r]=this.rand256(r)/256,r++,e[r]=this.rand256(r)/256,r++,e[r]=this.rand256(r)/256,r++,e[r]=1,r++;return e}static genvoxels(e){let r=new Float32Array(size*size*size*4),t=0;for(;t<r.length;)if(this.rand256(t+1009831)>210){let a=4*this.rand256(t+1031);r[t]=e[a],t++,r[t]=e[a+1],t++,r[t]=e[a+2],t++,r[t]=e[a+3],t++}else r[t]=0,t++,r[t]=0,t++,r[t]=0,t++,r[t]=0,t++;return r}static get(){return this.genvoxels(this.gencolors())}}function floatstr(e){let r=`${e}`;return r.indexOf(".")<0&&(r+="."),r}PG.seed=Math.floor(Math.random()*Math.pow(2,31));let vertexsource=`#version 300 es\n            in vec2 screenpos;out vec2 uv;void main() {uv = vec2(screenpos.x*${floatstr(scalex)},screenpos.y*${floatstr(scaley)});gl_Position = vec4(screenpos.xy, 0.0, 1.0);}`;function gpc_raycast_testout(e,r){return r<0?`if(p.${e}<0.){return tocastsky;}`:`if(p.${e}>${floatstr(size)}){return tocastsky;}`}function gpc_raycast_inwhiletest(e,r,t,a,o){return`p.${e}${r<0?"-":"+"}=1.;${gpc_raycast_testout(e,r)}vec3 l=(p+vec3(${t<0?"0.":"-1."},${a<0?"0.":"-1."},${o<0?"0.":"-1."}))/${floatstr(size)};if((l.x<1.)&&(l.x>=0.)){if((l.y<1.)&&(l.y>=0.)){if((l.z<1.)&&(l.z>=0.)){vec4 i=texture(voxelscolors,l);if(i.w>${floatstr(1/256/4)}){return casted(t.${e}*dray+s,${"xyz".indexOf(e)},i);}}}}t.${e}=opi(p.${e},dray.${e},s.${e});`}function gpc_raycast(e,r,t){return`vec3 p=vec3(${e<0?"floor":"ceil"}(s.x),${r<0?"floor":"ceil"}(s.y),${t<0?"floor":"ceil"}(s.z));bool e=true;vec3 t=vec3(opi(p.x,dray.x,s.x),opi(p.y,dray.y,s.y),opi(p.z,dray.z,s.z));${gpc_raycast_testout("x",e)}${gpc_raycast_testout("y",r)}${gpc_raycast_testout("z",t)}while(e){if(t.x<t.y){if(t.x<t.z){${gpc_raycast_inwhiletest("x",e,e,r,t)}}else{${gpc_raycast_inwhiletest("z",t,e,r,t)}}}else{if(t.y<t.z){${gpc_raycast_inwhiletest("y",r,e,r,t)}}else{${gpc_raycast_inwhiletest("z",t,e,r,t)}}}}`}let fragmentsource=`#version 300 es\nprecision mediump float;precision mediump sampler3D;in vec2 uv;uniform vec3 pos;uniform vec2 rot;uniform sampler3D voxelscolors;out vec4 fragColor;float INFINITYLIKE=999999.;float REALLYSMALL=0.0001;float REALLYSMALL2=0.00016;vec3 SKYVECTOR=vec3(${floatstr(7)},${floatstr(2)},${floatstr(1)});struct casted {vec3 rpos;int efasata;vec4 i;};casted tocastsky=casted(vec3(0.,0.,0.),-1,vec4(0.));float opi(in float k, in float d, in float s){if(abs(d)<REALLYSMALL){return INFINITYLIKE;}return (k-s)/d;}casted raycast(in vec3 s, in vec3 dray){if(dray.x<0.){if(dray.y<0.){if(dray.z<0.){${gpc_raycast(-1,-1,-1)}}else{${gpc_raycast(-1,-1,1)}}}else{if(dray.z<0.){${gpc_raycast(-1,1,-1)}}else{${gpc_raycast(-1,1,1)}}}}else{if(dray.y<0.){if(dray.z<0.){${gpc_raycast(1,-1,-1)}}else{${gpc_raycast(1,-1,1)}}}else{if(dray.z<0.){${gpc_raycast(1,1,-1)}}else{${gpc_raycast(1,1,1)}}}}} float skynormangle(in vec3 dray){return 1.-acos(dot(SKYVECTOR,dray)/sqrt(dot(dray,dray)*${floatstr(54)}))/${floatstr(Math.PI)};}bool cheakoutnormangle(in vec3 dray,in vec3 dray2){return dot(dray2,dray)/sqrt(dot(dray,dray)*dot(dray2,dray2))<0.;}vec3 sky(in vec3 dray){float k=skynormangle(dray);if(k>${floatstr(.98)}){return vec3(0.96,0.96,0.81);}else{return vec3(0.75,0.85,0.99)*k;}}vec3 mirror(in vec3 d, in int m){if(m==0){return vec3(-d.x,d.yz);}else{if(m==1){return vec3(d.x,-d.y,d.z);}else{return vec3(d.xy,-d.z);}}}void main(){vec3 dray=vec3(${floatstr(fov)},uv.yx);float sin_r=sin(rot.y);float cos_r=cos(rot.y);dray.xy=mat2(cos_r,-sin_r,sin_r,cos_r)*dray.xy;sin_r=sin(rot.x);cos_r=cos(rot.x);dray.xz=mat2(cos_r,sin_r,-sin_r,cos_r)*dray.xz;casted a=raycast(pos,dray);if(a.efasata==-1){fragColor =  vec4(sky(dray),1.);return;}else{vec3 mdray=mirror(dray,a.efasata);vec3 col=a.i.xyz;if(a.efasata==0){if(cheakoutnormangle(mdray,vec3(1.,0.,0.))){fragColor =  vec4(col*skynormangle(mdray)/2.,1.);return;}}else{if(a.efasata==1){if(cheakoutnormangle(mdray,vec3(0.,1.,0.))){fragColor =  vec4(col*skynormangle(mdray)/2.,1.);return;}}else{if(cheakoutnormangle(mdray,vec3(0.,0.,1.))){fragColor =  vec4(col*skynormangle(mdray)/2.,1.);return;}}}vec3 pospmin=a.rpos+(SKYVECTOR/sqrt(dot(SKYVECTOR,SKYVECTOR))*REALLYSMALL2);casted b=raycast(pospmin,SKYVECTOR);if(b.efasata==-1){fragColor =  vec4(col*skynormangle(mdray),1.);return;}else{fragColor =  vec4(col*skynormangle(mdray)/2.,1.);return;}}fragColor = vec4(1., 1., 0., 1.);return;}`;function createShaderProgram(e,r,t){const a=e.createShader(e.VERTEX_SHADER);if(e.shaderSource(a,r),e.compileShader(a),!e.getShaderParameter(a,e.COMPILE_STATUS))return e.deleteShader(a),null;const o=e.createShader(e.FRAGMENT_SHADER);if(e.shaderSource(o,t),e.compileShader(o),!e.getShaderParameter(o,e.COMPILE_STATUS))return e.deleteShader(o),null;const s=e.createProgram();return e.attachShader(s,a),e.attachShader(s,o),e.linkProgram(s),e.getProgramParameter(s,e.LINK_STATUS)?(e.deleteShader(a),e.deleteShader(o),s):(e.deleteProgram(s),null)}const player={pos:{x:-1,y:-1,z:-1},rot:{x:0,y:0}};let optimize={anypress:!0};function setmovingfunctions(){canv.onmousemove=e=>{player.rot.x+=.003*e.movementX,player.rot.y+=.003*e.movementY,player.rot.x=(player.rot.x%(2*Math.PI)+2*Math.PI)%(2*Math.PI),player.rot.y>Math.PI/2?player.rot.y=Math.PI/2:player.rot.y<-Math.PI/2&&(player.rot.y=-Math.PI/2),optimize.anypress=!0},document.onkeydown=e=>{switch(e.code){case"KeyE":player.pos.x-=Math.cos(player.rot.y)*Math.cos(player.rot.x)*.13,player.pos.y+=.13*Math.sin(player.rot.y),player.pos.z-=Math.cos(player.rot.y)*Math.sin(player.rot.x)*.13,optimize.anypress=!0;break;case"KeyQ":player.pos.x+=Math.cos(player.rot.y)*Math.cos(player.rot.x)*.13,player.pos.y-=.13*Math.sin(player.rot.y),player.pos.z+=Math.cos(player.rot.y)*Math.sin(player.rot.x)*.13,optimize.anypress=!0;break;case"KeyW":player.pos.x+=.13*Math.cos(player.rot.x),player.pos.z+=.13*Math.sin(player.rot.x),optimize.anypress=!0;break;case"KeyS":player.pos.x-=.13*Math.cos(player.rot.x),player.pos.z-=.13*Math.sin(player.rot.x),optimize.anypress=!0;break;case"KeyA":player.pos.x+=.13*Math.sin(player.rot.x),player.pos.z-=.13*Math.cos(player.rot.x),optimize.anypress=!0;break;case"KeyD":player.pos.x-=.13*Math.sin(player.rot.x),player.pos.z+=.13*Math.cos(player.rot.x),optimize.anypress=!0;break;case"Space":player.pos.y+=.13,optimize.anypress=!0;break;case"ShiftLeft":player.pos.y-=.13,optimize.anypress=!0}return!1}}document.body.appendChild(canv),canv.onclick=()=>{canv.requestPointerLock(),canv.requestFullscreen(),setmovingfunctions()},document.oncontextmenu=()=>!1,document.onselect=()=>!1;const gl=canv.getContext("webgl2"),render=createShaderProgram(gl,vertexsource,fragmentsource);gl.useProgram(render),vertexsource=void 0,fragmentsource=void 0,gpc_raycast=void 0,gpc_raycast_inwhiletest=void 0,gpc_raycast_testout=void 0;let voxels=PG.get();const fullscreen=new Float32Array([-1,-1,-1,1,1,1,-1,-1,1,-1,1,1]),buffer=gl.createBuffer();gl.bindBuffer(gl.ARRAY_BUFFER,buffer),gl.bufferData(gl.ARRAY_BUFFER,fullscreen,gl.STATIC_DRAW);const texture=gl.createTexture();gl.bindTexture(gl.TEXTURE_3D,texture),gl.texImage3D(gl.TEXTURE_3D,0,gl.RGBA32F,size,size,size,0,gl.RGBA,gl.FLOAT,voxels),gl.texParameteri(gl.TEXTURE_3D,gl.TEXTURE_WRAP_S,gl.CLAMP_TO_EDGE),gl.texParameteri(gl.TEXTURE_3D,gl.TEXTURE_WRAP_T,gl.CLAMP_TO_EDGE),gl.texParameteri(gl.TEXTURE_3D,gl.TEXTURE_WRAP_R,gl.CLAMP_TO_EDGE),gl.texParameteri(gl.TEXTURE_3D,gl.TEXTURE_MIN_FILTER,gl.NEAREST),gl.texParameteri(gl.TEXTURE_3D,gl.TEXTURE_MAG_FILTER,gl.NEAREST),gl.bindTexture(gl.TEXTURE_3D,null);const screenposLoc=gl.getAttribLocation(render,"screenpos"),posLoc=gl.getUniformLocation(render,"pos"),rotLoc=gl.getUniformLocation(render,"rot"),voxelscolorsLoc=gl.getUniformLocation(render,"voxelscolors");function inr(){gl.enableVertexAttribArray(screenposLoc),gl.bindBuffer(gl.ARRAY_BUFFER,buffer),gl.vertexAttribPointer(screenposLoc,2,gl.FLOAT,!1,0,0),gl.activeTexture(gl.TEXTURE0),gl.bindTexture(gl.TEXTURE_3D,texture),gl.uniform1i(voxelscolorsLoc,0),gl.uniform3f(posLoc,player.pos.x,player.pos.y,player.pos.z),gl.uniform2f(rotLoc,player.rot.x,player.rot.y),gl.drawArrays(gl.TRIANGLES,0,6)}function r(e=0){optimize.anypress&&inr(e),optimize.anypress=!1,requestAnimationFrame(r)}loading.style.display="none",requestAnimationFrame(r);</script></body></html>
